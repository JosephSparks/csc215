 AS V1.42 Beta [Bld 183] - Source File goodbye.asm - Page 1 - 12/04/2020 09:35:07 PM


       1/       0 :                     ; goodbye.asm
       2/       0 :                     ; Written by Kevin Cole <ubuntourist@hacdc.org> 2020.10.18 (kjc)
       3/       0 :                     ;
       4/       0 :                     ; When the Altair just can't take it any more... ;-)
       5/       0 :                     ;
       6/       0 :                     ; REQUIRED READING: Altair 2SIO Serial I/O manual
       7/       0 :                     ; https://altairclone.com/downloads/manuals/Altair%202SIO%20Serial%20I-O.pdf
       8/       0 :                     ;
       9/       0 :                     ; OPTIONAL: RS-232 Data Control Signals and UART
      10/       0 :                     ; https://en.wikipedia.org/wiki/RS-232#Data_and_control_signals
      11/       0 :                     ; https://en.wikipedia.org/wiki/Universal_asynchronous_receiver-transmitter
      12/       0 :                     ;
      13/       0 :                     ; In order to understand communications between the Altair and an
      14/       0 :                     ; external device like a terminal, connected via the serial / USB
      15/       0 :                     ; cable, the above documents should be pondered. For details like:
      16/       0 :                     ;
      17/       0 :                     ;    UART = Universal Asynchronous Recever / Transmitter
      18/       0 :                     ;    XMIT = Transmit (OUT)
      19/       0 :                     ;    RECV = Receive  (IN)
      20/       0 :                     ;    RTS  = Request to Send
      21/       0 :                     ;
      22/       0 :                     ; Settings for synchronous (polled) communication:
      23/       0 :                     ;
      24/       0 :                     ; 15H = 0 0 0 1 0 1 0 1
      25/       0 :                     ;       ^ ^ ^ ^ ^ ^ ^ ^
      26/       0 :                     ;       | | | | | | | |
      27/       0 :                     ;       | | | | | | +-+-> 1 = Clock Divide = 16
      28/       0 :                     ;       | | | +-+-+-----> 5 = 8 Data bits, No parity, 1 Stop bit (8N1)
      29/       0 :                     ;       | +-+-----------> 0 = RTS = Low, XMIT interrupt = disabled
      30/       0 :                     ;       +---------------> 0 = RECV interrupt = disabled
      31/       0 :                     ;
      32/       0 :                     
      33/       0 :                     ; Constants
      34/       0 :                     
      35/       0 : =15O                CR:	EQU	0Dh	; ASCII CR  (Carriage Return, a.k.a. Ctrl-M)
      36/       0 : =12O                LF:	EQU	0Ah	; ASCII LF  (Line Feed a.k.a. Ctrl-J)
      37/       0 : =0O                 NUL:	EQU	00h	; ASCII NUL (Null)
      38/       0 :                     
      39/       0 : =20O                SIO1S:	EQU	10h	; Serial I/O communications port 1 STATUS
      40/       0 : =21O                SIO1D:	EQU	11h	; Serial I/O communications port 1 DATA
      41/       0 :                     
      42/       0 : =2O                 SENT:	EQU	002h	; Data sent. Output complete
      43/       0 : =3O                 MRST:	EQU	03h	; UART Master Reset
      44/       0 :                     
      45/       0 :                     ; Code segment
      46/       0 :                     
      47/       0 :                     	ORG	000h	; Load at memory location 000 (hex)
      48/       0 :                     
      49/       0 : 076 003             	MVI	A,MRST
      50/       2 : 323 020             	OUT	SIO1S	; Reset the UART
      51/       4 : 076 025             	MVI	A,15h	; Settings: No RI, No XI, RTS Low, 8N1, /16
      52/       6 : 323 020             	OUT	SIO1S	; Configure the UART with above settings
      53/      10 :                     
      54/      10 : 001 000 002         	LXI	B,WORDS	; Point to WORDS
      55/      13 :                     
      56/      13 : 333 020             FETCH:	IN	SIO1S	; Check serial I/O status bit 1 (XMIT status)
      57/      15 : 346 002             	ANI	SENT	; If data not sent (i.e. XMIT not finished)...
      58/      17 : 312 013 000         	JZ	FETCH	; ...spin wheels: continue checking status. Else...
      59/      22 : 012                 	LDAX	B	; ...Fetch byte
      60/      23 : 376 000             	CPI	NUL	; ...If byte is ASCII NUL...
 AS V1.42 Beta [Bld 183] - Source File goodbye.asm - Page 2 - 12/04/2020 09:35:07 PM


      61/      25 : 312 036 000         	JZ	HCF	; ......finish. Else...
      62/      30 : 323 021             	OUT	SIO1D	; ......output byte
      63/      32 : 003                 	INX	B	; ......point to next byte
      64/      33 : 303 013 000         	JMP	FETCH	; ......lather, rinse, repeat: Fetch next byte.
      65/      36 :                     
      66/      36 : 166                 HCF:	HLT		; Halt and Catch Fire ;-)
      67/      37 :                     
      68/      37 :                     ; Data segment
      69/      37 :                     
      70/    1000 :                     	ORG	200h	; Load at memory locaton 200 (hex)
      71/    1000 :                     
      72/    1000 : 107 157 157 144     WORDS:	DB	'Good-bye, cruel world!'
             1004 : 055 142 171 145 
             1010 : 054 040 143 162 
             1014 : 165 145 154 040 
             1020 : 167 157 162 154 
             1024 : 144 041         
      73/    1026 : 015 012             	DB	CR,LF	; Old-school CRLF newline
      74/    1030 : 000                 	DB	NUL	; NULL string terminator
      75/    1031 :                     
      76/    1031 :                     	END
 AS V1.42 Beta [Bld 183] - Source File goodbye.asm - Page 3 - 12/04/2020 09:35:07 PM


  Symbol Table (* = unused):
  --------------------------

*ARCHITECTURE :                                      "x86_64-unknown-linux" - |
*BIGENDIAN :                      0 - | *BRANCHEXT :                      0 - |
*CASESENSITIVE :                  0 - | *CONSTPI :        3.141592653589793 - |
 CR :                            15 - | *DATE :                "12/04/2020" - |
*FALSE :                          0 - |  FETCH :                         13 C |
*FULLPMMU :                       1 - | *HAS64 :                          1 - |
*HASDSP :                         0 - | *HASFPU :                         0 - |
*HASPMMU :                        0 - |  HCF :                           36 C |
*INEXTMODE :                      0 - | *INLWORDMODE :                    0 - |
*INMAXMODE :                      0 - | *INSRCMODE :                      0 - |
*INSUPMODE :                      0 - |  LF :                            12 - |
*LISTON :                         1 - | *MACEXP :                         7 - |
*MOMCPU :                    100200 - | *MOMCPUNAME :                "8080" - |
 MRST :                           3 - | *NESTMAX :                      400 - |
 NUL :                            0 - | *PACKING :                        0 - |
*PADDING :                        1 - | *RELAXED :                        0 - |
 SENT :                           2 - |  SIO1D :                         21 - |
 SIO1S :                         20 - | *TIME :               "09:35:07 PM" - |
*TRUE :                           1 - | *VERSION :                    12057 - |
 WORDS :                       1000 C | *Z80SYNTAX :                      0 - |

     39 symbols
     29 unused symbols

 AS V1.42 Beta [Bld 183] - Source File goodbye.asm - Page 4 - 12/04/2020 09:35:07 PM


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.01 seconds assembly time

     77 lines source file
      2 passes
      0 errors
      0 warnings
